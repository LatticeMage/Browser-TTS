<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simple Browser</title>
    <style>
      .address-bar {
        display: flex;
      }
      .address-bar input {
        flex: 1;
      }
      .main {
          height: calc(100vh - 60px);
        overflow-y: auto;
      }
      .selected-text-box{
          height: 20px;
          padding: 10px;
      }
    </style>
</head>
<body>
  <div class="address-bar">
      <input type="text" id="url-input" placeholder="Enter URL here">
      <button onclick="loadURL()">â†’</button>
    </div>
  <div class="selected-text-box">
    Selected Text: <span id="selected-text"></span>
  </div>
    <div class="main">
       <webview id="webview" style="width:100%; height:100%;"></webview>
   </div>
   <script src="select_text.js"></script>
   <script>
     const webview = document.getElementById('webview');
      const urlInput = document.getElementById('url-input');

      function loadURL() {
          const url = urlInput.value;
          let urlToLoad = url;

          if (!url.startsWith('http://') && !url.startsWith('https://')) {
              urlToLoad = 'http://' + url;
          }
          webview.src = urlToLoad;
      }


     webview.addEventListener('did-finish-load', () => {
        urlInput.value = webview.getURL(); // Update input value after successful navigation
     });


     webview.addEventListener('will-navigate', (event) => {
      urlInput.value = event.url;
    });

    webview.addEventListener('dom-ready', () => {
          webview.executeJavaScript(`
            document.addEventListener('selectionchange', () => {
              const selectedText = window.getSelection().toString();
              if (window.api) {
                window.api.handleSelectionChange()
              }

              window.postMessage({type: 'selectionChange', text: selectedText}, '*');
            });
          `);
        });

        window.addEventListener('message', (event) => {
            if(event.data && event.data.type === 'selectionChange'){
                const selectedTextDisplay = document.getElementById('selected-text');
                 if (selectedTextDisplay) {
                  selectedTextDisplay.textContent = event.data.text;
                }
            }

        })



   </script>
</body>
</html>